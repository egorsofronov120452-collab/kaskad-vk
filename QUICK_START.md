# Быстрый старт - VK бот для управления чатами

## Основные команды

### !инвайт - Приглашение пользователей

```
!инвайт vk.com/id123456789 рс
!инвайт vk.com/id987654321 курьер
!инвайт id555555555 спонсор
```

**Роли:**
- `рс` - все чаты
- `сс` - все кроме руководства
- `курьер` - рабочие чаты (флудилка, журнал, диспетчерская, доска)
- `стажёр` - учебный центр + базовые чаты
- `спонсор` - дополнительная роль, только чат спонсорства

---

### !пост - Публикация в группу

**С текстом и фото:**
1. Напишите сообщение: "Новость дня!"
2. Прикрепите фото
3. Ответьте на своё сообщение: `!пост`

**С любыми вложениями:**
- Фото (сжимаются автоматически)
- Видео
- Аудио
- Документы
- Опросы

---

### !приветствие - Настройка приветствия

**Простое текстовое:**
1. Напишите: "Привет, {user}! Добро пожаловать!"
2. Ответьте: `!приветствие`

**С картинкой:**
1. Напишите текст приветствия
2. Прикрепите гифку или фото
3. Ответьте: `!приветствие`

**Для другого чата:**
```
!приветствие 123
```
(где 123 - ID чата)

---

### !закреп - Закрепление сообщений

**В текущем чате:**
1. Ответьте на нужное сообщение
2. Напишите: `!закреп`

**В другом чате:**
1. Создайте сообщение с текстом и вложениями
2. Ответьте: `!закреп 123` (где 123 - ID чата)
3. Бот скопирует сообщение туда и закрепит

---

### !кик - Удаление пользователей

**С баном:**
```
!кик vk.com/id123456789 30
```
(кикнет из всех чатов + бан на 30 дней)

**Перманентный бан:**
```
!кик vk.com/id123456789 999
```

**Только из спонсорской:**
```
!кик vk.com/id123456789 спонсор
```

---

### !увед - Упомянуть всех

```
!увед
```
(упоминает всех участников текущего чата)

---

## Примеры использования

### Пример 1: Принять стажёра

```
!инвайт vk.com/id123456789 стажёр
```
✅ Добавит в: Учебный Центр, Доску Объявлений, Диспетчерскую

### Пример 2: Повысить до курьера

```
!инвайт vk.com/id123456789 курьер
```
✅ Добавит в: Флудилку, Журнал, Диспетчерскую, Доску

### Пример 3: Опубликовать новость с фото

1. Напишите: "Важная новость! Сегодня..."
2. Прикрепите фото
3. Ответьте: `!пост`
✅ Опубликует в группе со всеми вложениями

### Пример 4: Установить приветствие с гифкой

1. Напишите: "Привет, {user}! Рады видеть тебя в нашей команде!"
2. Прикрепите приветственную гифку
3. Ответьте: `!приветствие`
✅ Новые участники будут получать это сообщение с гифкой

### Пример 5: Закрепить объявление во всех чатах

1. Создайте сообщение: "Важно! Завтра собрание в 15:00"
2. Прикрепите расписание (фото)
3. Для каждого чата: `!закреп [ID чата]`

---

## ID чатов

Узнать ID чата можно:
1. Открыть беседу в браузере → URL: `...?sel=c123` (ID = 123)
2. Использовать команду без ID в нужной беседе

**Настройка в .env:**
```
VK_CHAT_RUKOVODSTVO_ID=xxx
VK_CHAT_SS_ID=xxx
VK_CHAT_UCHEBNY_ID=xxx
VK_CHAT_DOSKA_ID=xxx
VK_CHAT_DISPETCHERSKAYA_ID=xxx
VK_CHAT_FLUDILKA_ID=xxx
VK_CHAT_ZHURNAL_ID=xxx
VK_CHAT_SPONSOR_ID=xxx
```

---

## Доступ к командам

| Команда | РС | СС | Другие |
|---------|----|----|--------|
| !пост | ✅ | ❌ | ❌ |
| !приветствие | ✅ | ❌ | ❌ |
| !закреп | ✅ | ❌ | ❌ |
| !инвайт | ✅ | ✅ | ❌ |
| !кик | ✅ | ✅ | ❌ |
| !увед | ✅ | ✅ | ❌ |

---

## Автоматические функции

### Приветствие новичков
Когда кто-то присоединяется к чату с настроенным приветствием:
- Автоматически отправляется приветственное сообщение
- {user} заменяется на упоминание нового участника
- Отправляются все прикреплённые вложения

### Обработка самоливов
Когда кто-то покидает беседу:
- Автоматически кикается из всех остальных чатов
- В Руководство отправляется уведомление с кнопками для бана

---

## Запуск и управление

**Запуск:**
```bash
node scripts/long-polling.cjs
```

**PM2 (рекомендуется):**
```bash
pm2 start scripts/long-polling.cjs --name vk-bot
pm2 save
pm2 startup
```

**Управление через PM2:**
```bash
pm2 status          # статус
pm2 logs vk-bot     # логи
pm2 restart vk-bot  # перезапуск
pm2 stop vk-bot     # остановка
```

---

## Полная документация

Подробная информация по каждой команде: **[VK_BOT_COMMANDS.md](VK_BOT_COMMANDS.md)**

История обновлений: **[UPDATE_NOTES.md](UPDATE_NOTES.md)**
